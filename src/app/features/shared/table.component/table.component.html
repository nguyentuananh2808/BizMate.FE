<div
  class="p-6 bg-white dark:bg-gray-900 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700"
>
  <!-- Search -->
  <div class="mb-5 flex justify-between items-center">
    <input
      type="text"
      [(ngModel)]="searchText"
      placeholder="T√¨m ki·∫øm..."
      class="w-1/3 px-4 py-2 text-sm border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
    />
  </div>

  <!-- Loading -->
  <ng-container *ngIf="isLoading; else tableOrEmpty">
    <div
      class="py-10 text-center text-gray-500 dark:text-gray-400 animate-pulse"
    >
      ‚è≥ ƒêang t·∫£i d·ªØ li·ªáu...
    </div>
  </ng-container>

  <!-- Table or Empty -->
  <ng-template #tableOrEmpty>
    <ng-container *ngIf="data && data.length > 0; else noData">
      <div class="overflow-x-auto border rounded-xl dark:border-gray-700">
        <table class="w-full text-sm text-left border-collapse">
          <!-- Table Header -->
          <thead
            class="bg-gray-50 dark:bg-gray-800 text-gray-600 dark:text-gray-300 uppercase text-xs tracking-wide"
          >
            <tr>
              <th class="p-4 w-4">
                <input type="checkbox" disabled />
              </th>
              <th
                *ngFor="let col of columns"
                class="p-4 whitespace-nowrap cursor-pointer select-none"
                (click)="col.sortable && toggleSort(col.key)"
              >
                <div class="flex items-center gap-1">
                  {{ col.label }}
                  <ng-container *ngIf="col.sortable">
                    <span *ngIf="sortKey === col.key">
                      {{ sortAsc ? "‚ñ≤" : "‚ñº" }}
                    </span>
                    <span *ngIf="sortKey !== col.key">‚áÖ</span>
                  </ng-container>
                </div>
              </th>
            </tr>
          </thead>

          <!-- Table Body -->
          <tbody>
            <tr
              *ngFor="let row of pagedData"
              [class.bg-blue-50]="isSelected(row)"
              (click)="toggleSelect(row)"
              class="hover:bg-gray-50 dark:hover:bg-gray-800 border-t border-gray-100 dark:border-gray-700 transition duration-100"
            >
              <td class="p-4">
                <input type="checkbox" [checked]="isSelected(row)" />
              </td>
              <td
                *ngFor="let col of columns"
                class="p-4 whitespace-nowrap text-gray-900 dark:text-gray-200"
              >
                <ng-container
                  *ngIf="customTemplates[col.key]; else defaultCell"
                >
                  <ng-container
                    *ngTemplateOutlet="
                      customTemplates[col.key];
                      context: { $implicit: row }
                    "
                  ></ng-container>
                </ng-container>
                <ng-template #defaultCell>{{ row[col.key] }}</ng-template>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Pagination -->
      <div
        *ngIf="totalPages > 1"
        class="mt-6 flex justify-between items-center text-sm text-gray-600 dark:text-gray-400"
      >
        <div>Trang {{ currentPage }} / {{ totalPages }}</div>
        <div class="flex gap-1">
          <button
            (click)="currentPage = currentPage - 1"
            [disabled]="currentPage === 1"
            class="px-3 py-1 rounded-md border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50"
          >
            ‚Üê Tr∆∞·ªõc
          </button>
          <button
            *ngFor="let page of [].constructor(totalPages); let i = index"
            (click)="currentPage = i + 1"
            class="px-3 py-1 rounded-md border"
            [ngClass]="{
              'bg-blue-500 text-white': currentPage === i + 1,
              'border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700':
                currentPage !== i + 1
            }"
          >
            {{ i + 1 }}
          </button>
          <button
            (click)="currentPage = currentPage + 1"
            [disabled]="currentPage === totalPages"
            class="px-3 py-1 rounded-md border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50"
          >
            Sau ‚Üí
          </button>
        </div>
      </div>
    </ng-container>

    <!-- No Data -->
    <ng-template #noData>
      <div class="py-10 text-center text-gray-500 dark:text-gray-400">
        üì≠ Kh√¥ng c√≥ d·ªØ li·ªáu.
      </div>
    </ng-template>
  </ng-template>
</div>
